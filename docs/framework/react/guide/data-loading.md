# Table of Contents

- [ë°ì´í„° ë¡œë”©](#ë°ì´í„°-ë¡œë”©)
  - [ë¼ìš°íŠ¸ ë¡œë”© ìƒëª…ì£¼ê¸°](#ë¼ìš°íŠ¸-ë¡œë”©-ìƒëª…ì£¼ê¸°)
  - [ë¼ìš°í„° ìºì‹œë¥¼ ì‚¬ìš©í• ê¹Œìš”, ë§ê¹Œìš”?](#ë¼ìš°í„°-ìºì‹œë¥¼-ì‚¬ìš©í• ê¹Œìš”-ë§ê¹Œìš”)
    - [TanStack ë¼ìš°í„° ìºì‹œì˜ ì¥ì ](#tanstack-ë¼ìš°í„°-ìºì‹œì˜-ì¥ì )
    - [TanStack ë¼ìš°í„° ìºì‹œì˜ ë‹¨ì ](#tanstack-ë¼ìš°í„°-ìºì‹œì˜-ë‹¨ì )
  - [ë¼ìš°í„° ìºì‹œ ì‚¬ìš©í•˜ê¸°](#ë¼ìš°í„°-ìºì‹œ-ì‚¬ìš©í•˜ê¸°)
  - [ë¼ìš°íŠ¸ `loader` í•¨ìˆ˜](#ë¼ìš°íŠ¸-loader-í•¨ìˆ˜)
  - [`loader` í•¨ìˆ˜ì˜ ë§¤ê°œë³€ìˆ˜](#loader-í•¨ìˆ˜ì˜-ë§¤ê°œë³€ìˆ˜)
  - [`loader`ì—ì„œ ë°ì´í„° ì‚¬ìš©í•˜ê¸°](#loaderì—ì„œ-ë°ì´í„°-ì‚¬ìš©í•˜ê¸°)
  - [ì˜ì¡´ì„± ê¸°ë°˜ Stale-While-Revalidate ìºì‹±](#ì˜ì¡´ì„±-ê¸°ë°˜-stale-while-revalidate-ìºì‹±)
    - [ì£¼ìš” ì˜µì…˜](#ì£¼ìš”-ì˜µì…˜)
    - [âš ï¸ ëª‡ ê°€ì§€ ì¤‘ìš”í•œ ê¸°ë³¸ê°’](#-ëª‡-ê°€ì§€-ì¤‘ìš”í•œ-ê¸°ë³¸ê°’)
    - [`loaderDeps`ë¥¼ ì‚¬ìš©í•´ ê²€ìƒ‰ íŒŒë¼ë¯¸í„°ì— ì ‘ê·¼í•˜ê¸°](#loaderdepsë¥¼-ì‚¬ìš©í•´-ê²€ìƒ‰-íŒŒë¼ë¯¸í„°ì—-ì ‘ê·¼í•˜ê¸°)
    - [`staleTime`ì„ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ê°€ ì‹ ì„ í•˜ë‹¤ê³  ê°„ì£¼ë˜ëŠ” ì‹œê°„ ì œì–´í•˜ê¸°](#staletimeì„-ì‚¬ìš©í•˜ì—¬-ë°ì´í„°ê°€-ì‹ ì„ í•˜ë‹¤ê³ -ê°„ì£¼ë˜ëŠ”-ì‹œê°„-ì œì–´í•˜ê¸°)
  - [stale-while-revalidate ìºì‹± ë¹„í™œì„±í™”í•˜ê¸°](#stale-while-revalidate-ìºì‹±-ë¹„í™œì„±í™”í•˜ê¸°)
  - [ìºì‹±ì—ì„œ ì œì™¸í•˜ê¸° ìœ„í•´ `shouldReload`ì™€ `gcTime` ì‚¬ìš©í•˜ê¸°](#ìºì‹±ì—ì„œ-ì œì™¸í•˜ê¸°-ìœ„í•´-shouldreloadì™€-gctime-ì‚¬ìš©í•˜ê¸°)
    - [ìºì‹±ì„ ì‚¬ìš©í•˜ì§€ ì•Šìœ¼ë©´ì„œë„ ë¯¸ë¦¬ ê°€ì ¸ì˜¤ê¸° í™œìš©í•˜ê¸°](#ìºì‹±ì„-ì‚¬ìš©í•˜ì§€-ì•Šìœ¼ë©´ì„œë„-ë¯¸ë¦¬-ê°€ì ¸ì˜¤ê¸°-í™œìš©í•˜ê¸°)
  - [ëª¨ë“  ë¡œë” ì´ë²¤íŠ¸ë¥¼ ì™¸ë¶€ ìºì‹œë¡œ ì „ë‹¬í•˜ê¸°](#ëª¨ë“ -ë¡œë”-ì´ë²¤íŠ¸ë¥¼-ì™¸ë¶€-ìºì‹œë¡œ-ì „ë‹¬í•˜ê¸°)
  - [ë¼ìš°í„° ì»¨í…ìŠ¤íŠ¸ ì‚¬ìš©í•˜ê¸°](#ë¼ìš°í„°-ì»¨í…ìŠ¤íŠ¸-ì‚¬ìš©í•˜ê¸°)
  - [ê²½ë¡œ íŒŒë¼ë¯¸í„° ì‚¬ìš©í•˜ê¸°](#ê²½ë¡œ-íŒŒë¼ë¯¸í„°-ì‚¬ìš©í•˜ê¸°)
  - [ë¼ìš°íŠ¸ ì»¨í…ìŠ¤íŠ¸ ì‚¬ìš©í•˜ê¸°](#ë¼ìš°íŠ¸-ì»¨í…ìŠ¤íŠ¸-ì‚¬ìš©í•˜ê¸°)
  - [ë¡œë”ì—ì„œ ê²€ìƒ‰ íŒŒë¼ë¯¸í„° ì‚¬ìš©í•˜ê¸°](#ë¡œë”ì—ì„œ-ê²€ìƒ‰-íŒŒë¼ë¯¸í„°-ì‚¬ìš©í•˜ê¸°)
    - [`routeOptions.loaderDeps`ë¥¼ í†µí•´ ê²€ìƒ‰ íŒŒë¼ë¯¸í„° ì ‘ê·¼í•˜ê¸°](#routeoptionsloaderdepsë¥¼-í†µí•´-ê²€ìƒ‰-íŒŒë¼ë¯¸í„°-ì ‘ê·¼í•˜ê¸°)
  - [Abort Signal ì‚¬ìš©í•˜ê¸°](#abort-signal-ì‚¬ìš©í•˜ê¸°)
  - [`preload` í”Œë˜ê·¸ ì‚¬ìš©í•˜ê¸°](#preload-í”Œë˜ê·¸-ì‚¬ìš©í•˜ê¸°)
  - [ëŠë¦° ë¡œë” ì²˜ë¦¬í•˜ê¸°](#ëŠë¦°-ë¡œë”-ì²˜ë¦¬í•˜ê¸°)
  - [ë¡œë”© ì¤‘ì¸ ì»´í¬ë„ŒíŠ¸ í‘œì‹œí•˜ê¸°](#ë¡œë”©-ì¤‘ì¸-ì»´í¬ë„ŒíŠ¸-í‘œì‹œí•˜ê¸°)
  - [Pending ì»´í¬ë„ŒíŠ¸ ê¹œë¹¡ì„ ë°©ì§€](#pending-ì»´í¬ë„ŒíŠ¸-ê¹œë¹¡ì„-ë°©ì§€)
  - [ì—ëŸ¬ ì²˜ë¦¬í•˜ê¸°](#ì—ëŸ¬-ì²˜ë¦¬í•˜ê¸°)
    - [`routeOptions.onError`ë¡œ ì—ëŸ¬ ì²˜ë¦¬í•˜ê¸°](#routeoptionsonerrorë¡œ-ì—ëŸ¬-ì²˜ë¦¬í•˜ê¸°)
    - [`routeOptions.onCatch`ë¥¼ ì‚¬ìš©í•œ ì—ëŸ¬ ì²˜ë¦¬](#routeoptionsoncatchë¥¼-ì‚¬ìš©í•œ-ì—ëŸ¬-ì²˜ë¦¬)
    - [`routeOptions.errorComponent`ë¡œ ì—ëŸ¬ ì²˜ë¦¬í•˜ê¸°](#routeoptionserrorcomponentë¡œ-ì—ëŸ¬-ì²˜ë¦¬í•˜ê¸°)
    - [ê¸°ë³¸ `ErrorComponent` ì‚¬ìš©í•˜ê¸°](#ê¸°ë³¸-errorcomponent-ì‚¬ìš©í•˜ê¸°)

# ë°ì´í„° ë¡œë”©

ë°ì´í„° ë¡œë”©ì€ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ í”íˆ ë°œìƒí•˜ëŠ” ë¬¸ì œì´ë©°, ë¼ìš°íŒ…ê³¼ ë°€ì ‘í•œ ê´€ë ¨ì´ ìˆìŠµë‹ˆë‹¤. ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ í˜ì´ì§€ë¥¼ ë¡œë“œí•  ë•Œ, í˜ì´ì§€ì˜ ëª¨ë“  ë¹„ë™ê¸° ìš”êµ¬ì‚¬í•­ì„ ê°€ëŠ¥í•œ í•œ ë¹ ë¥´ê³  ë³‘ë ¬ë¡œ ê°€ì ¸ì™€ ì²˜ë¦¬í•˜ëŠ” ê²ƒì´ ì´ìƒì ì…ë‹ˆë‹¤. ë¼ìš°í„°ëŠ” ì´ëŸ¬í•œ ë¹„ë™ê¸° ì˜ì¡´ì„±ì„ ì¡°ìœ¨í•˜ê¸°ì— ê°€ì¥ ì í•©í•œ ìœ„ì¹˜ì…ë‹ˆë‹¤. ì¼ë°˜ì ìœ¼ë¡œ ë¼ìš°í„°ëŠ” ì½˜í…ì¸ ê°€ ë Œë”ë§ë˜ê¸° ì „ì— ì‚¬ìš©ìê°€ ì–´ë””ë¡œ í–¥í•˜ëŠ”ì§€ ì•Œê³  ìˆëŠ” ìœ ì¼í•œ ê³³ì´ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.

ì—¬ëŸ¬ë¶„ì€ Next.jsì˜ `getServerSideProps`ë‚˜ Remix/React-Routerì˜ `loader`ì— ìµìˆ™í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. TanStack Routerë„ ë¼ìš°íŠ¸ë³„ë¡œ ìì‚°ì„ ë¯¸ë¦¬ ë¡œë“œí•˜ê±°ë‚˜ ë³‘ë ¬ë¡œ ë¡œë“œí•˜ëŠ” ìœ ì‚¬í•œ ê¸°ëŠ¥ì„ ì œê³µí•©ë‹ˆë‹¤. ì´ë¥¼ í†µí•´ ReactëŠ” Suspenseë¥¼ í†µí•´ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ëŠ” ë™ì•ˆ ê°€ëŠ¥í•œ í•œ ë¹ ë¥´ê²Œ ë Œë”ë§í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì¼ë°˜ì ì¸ ë¼ìš°í„°ì˜ ê¸°ëŒ€ì¹˜ë¥¼ ë„˜ì–´, TanStack RouterëŠ” **ë‚´ì¥ëœ SWR ìºì‹±** ê¸°ëŠ¥ì„ ì œê³µí•©ë‹ˆë‹¤. ì´ëŠ” ë¼ìš°íŠ¸ ë¡œë”ë¥¼ ìœ„í•œ ì¥ê¸°ì ì¸ ë©”ëª¨ë¦¬ ë‚´ ìºì‹± ë ˆì´ì–´ì…ë‹ˆë‹¤. ë”°ë¼ì„œ TanStack Routerë¥¼ ì‚¬ìš©í•˜ë©´ ë¼ìš°íŠ¸ ë°ì´í„°ë¥¼ ë¯¸ë¦¬ ë¡œë“œí•˜ì—¬ ì¦‰ì‹œ ë¡œë“œë˜ë„ë¡ í•˜ê±°ë‚˜, ì´ì „ì— ë°©ë¬¸í•œ ë¼ìš°íŠ¸ì˜ ë°ì´í„°ë¥¼ ì„ì‹œë¡œ ìºì‹œí•˜ì—¬ ë‚˜ì¤‘ì— ë‹¤ì‹œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.


## ë¼ìš°íŠ¸ ë¡œë”© ìƒëª…ì£¼ê¸°

URL ë˜ëŠ” íˆìŠ¤í† ë¦¬ ì—…ë°ì´íŠ¸ê°€ ê°ì§€ë  ë•Œë§ˆë‹¤, ë¼ìš°í„°ëŠ” ë‹¤ìŒ ìˆœì„œëŒ€ë¡œ ì‘ì—…ì„ ì‹¤í–‰í•©ë‹ˆë‹¤:

1. **ë¼ìš°íŠ¸ ë§¤ì¹­ (ìƒìœ„ì—ì„œ í•˜ìœ„ë¡œ)**
   - `route.params.parse`
   - `route.validateSearch`

2. **ë¼ìš°íŠ¸ ì‚¬ì „ ë¡œë”© (ìˆœì°¨ì )**
   - `route.beforeLoad`
   - `route.onError`
     - `route.errorComponent` / `parentRoute.errorComponent` / `router.defaultErrorComponent`

3. **ë¼ìš°íŠ¸ ë¡œë”© (ë³‘ë ¬)**
   - `route.component.preload?`
   - `route.loader`
     - `route.pendingComponent` (ì„ íƒ ì‚¬í•­)
     - `route.component`
   - `route.onError`
     - `route.errorComponent` / `parentRoute.errorComponent` / `router.defaultErrorComponent`

ì´ ê³¼ì •ì„ í†µí•´ ë¼ìš°í„°ëŠ” URL ë³€ê²½ì— ë”°ë¼ í•„ìš”í•œ ì»´í¬ë„ŒíŠ¸ì™€ ë°ì´í„°ë¥¼ íš¨ìœ¨ì ìœ¼ë¡œ ë¡œë“œí•˜ê³ , ì˜¤ë¥˜ ë°œìƒ ì‹œ ì ì ˆí•œ ëŒ€ì‘ì„ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.


## ë¼ìš°í„° ìºì‹œë¥¼ ì‚¬ìš©í• ê¹Œìš”, ë§ê¹Œìš”?

TanStackì˜ ë¼ìš°í„° ìºì‹œëŠ” ëŒ€ë¶€ë¶„ì˜ ì¤‘ì†Œê·œëª¨ ì• í”Œë¦¬ì¼€ì´ì…˜ì— ì í•©í•  ê°€ëŠ¥ì„±ì´ ë†’ìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ì´ë¥¼ ì‚¬ìš©í•  ë•Œì˜ ì¥ë‹¨ì ê³¼ TanStack Queryì™€ ê°™ì€ ë” ê°•ë ¥í•œ ìºì‹± ì†”ë£¨ì…˜ê³¼ì˜ ì°¨ì´ë¥¼ ì´í•´í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•©ë‹ˆë‹¤.

### TanStack ë¼ìš°í„° ìºì‹œì˜ ì¥ì 

- **ë‚´ì¥í˜•ìœ¼ë¡œ ì‚¬ìš©ì´ ê°„í¸í•˜ë©° ì¶”ê°€ ì˜ì¡´ì„±ì´ í•„ìš” ì—†ìŒ**
- **ë¼ìš°íŠ¸ ë‹¨ìœ„ë¡œ ì¤‘ë³µ ì œê±°, ë¯¸ë¦¬ ê°€ì ¸ì˜¤ê¸°, ë¡œë”©, stale-while-revalidate, ë°±ê·¸ë¼ìš´ë“œ ë¦¬í˜ì¹­ ì²˜ë¦¬**
- **ì „ì²´ ë¼ìš°íŠ¸ì™€ ìºì‹œë¥¼ í•œ ë²ˆì— ë¬´íš¨í™”í•˜ëŠ” ê°„ë‹¨í•œ ë¬´íš¨í™” ë°©ì‹**
- **ìë™ ê°€ë¹„ì§€ ì»¬ë ‰ì…˜**
- **ë¼ìš°íŠ¸ ê°„ ë°ì´í„° ê³µìœ ê°€ ì ì€ ì•±ì— ì í•©**
- **SSRì—ì„œ "ê·¸ëƒ¥ ì‘ë™"**

### TanStack ë¼ìš°í„° ìºì‹œì˜ ë‹¨ì 

- **ì§€ì†ì„± ì–´ëŒ‘í„°/ëª¨ë¸ì´ ì—†ìŒ**
- **ë¼ìš°íŠ¸ ê°„ ê³µìœ  ìºì‹±/ì¤‘ë³µ ì œê±° ê¸°ëŠ¥ ì—†ìŒ**
- **ë‚´ì¥ëœ ë®¤í…Œì´ì…˜ APIê°€ ì—†ìŒ (ë§ì€ ì˜ˆì œì—ì„œ ì œê³µë˜ëŠ” ê¸°ë³¸ `useMutation` í›…ìœ¼ë¡œ ì¶©ë¶„í•  ìˆ˜ ìˆìŒ)**
- **ë‚´ì¥ëœ ìºì‹œ ìˆ˜ì¤€ì˜ ë‚™ê´€ì  ì—…ë°ì´íŠ¸ APIê°€ ì—†ìŒ (ì»´í¬ë„ŒíŠ¸ ìˆ˜ì¤€ì—ì„œ `useMutation` í›…ê³¼ ê°™ì€ ì„ì‹œ ìƒíƒœë¥¼ ì‚¬ìš©í•˜ì—¬ ì´ë¥¼ ë‹¬ì„±í•  ìˆ˜ ìˆìŒ)**

> [!TIP]
> TanStack Queryì™€ ê°™ì€ ë” ê°•ë ¥í•œ ì†”ë£¨ì…˜ì„ ì‚¬ìš©í•˜ê³  ì‹¶ê±°ë‚˜ í•„ìš”í•˜ë‹¤ë©´, [ì™¸ë¶€ ë°ì´í„° ë¡œë”©](./external-data-loading.md) ê°€ì´ë“œë¡œ ë°”ë¡œ ì´ë™í•˜ì„¸ìš”.


## ë¼ìš°í„° ìºì‹œ ì‚¬ìš©í•˜ê¸°

ë¼ìš°í„° ìºì‹œëŠ” ë‚´ì¥ë˜ì–´ ìˆìœ¼ë©°, ë¼ìš°íŠ¸ì˜ `loader` í•¨ìˆ˜ì—ì„œ ë°ì´í„°ë¥¼ ë°˜í™˜í•˜ëŠ” ê²ƒë§Œí¼ ì‰½ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. í•¨ê»˜ ì•Œì•„ë´…ì‹œë‹¤!


## ë¼ìš°íŠ¸ `loader` í•¨ìˆ˜

ë¼ìš°íŠ¸ `loader` í•¨ìˆ˜ëŠ” ë¼ìš°íŠ¸ê°€ ë§¤ì¹˜ë  ë•Œ í˜¸ì¶œë©ë‹ˆë‹¤. ì´ í•¨ìˆ˜ëŠ” ìœ ìš©í•œ ì†ì„±ë“¤ì„ ë‹´ê³  ìˆëŠ” ê°ì²´ë¥¼ ë‹¨ì¼ ì¸ìë¡œ ë°›ìŠµë‹ˆë‹¤. ì´ ì†ì„±ë“¤ì— ëŒ€í•´ì„œëŠ” ì ì‹œ í›„ì— ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤. ë¨¼ì €, ë¼ìš°íŠ¸ `loader` í•¨ìˆ˜ì˜ ì˜ˆì œë¥¼ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤:

```tsx
// routes/posts.tsx
export const Route = createFileRoute('/posts')({
  loader: () => fetchPosts(),
})
```


## `loader` í•¨ìˆ˜ì˜ ë§¤ê°œë³€ìˆ˜

`loader` í•¨ìˆ˜ëŠ” ë‹¤ìŒê³¼ ê°™ì€ ì†ì„±ì„ ê°€ì§„ ë‹¨ì¼ ê°ì²´ë¥¼ ë°›ìŠµë‹ˆë‹¤:

- `abortController` - ë¼ìš°íŠ¸ì˜ abortControllerì…ë‹ˆë‹¤. ë¼ìš°íŠ¸ê°€ ì–¸ë¡œë“œë˜ê±°ë‚˜ ë” ì´ìƒ ê´€ë ¨ì´ ì—†ì–´ì§€ê³  í˜„ì¬ `loader` í•¨ìˆ˜ í˜¸ì¶œì´ ì˜¤ë˜ëœ ê²½ìš°, ì´ ì‹ í˜¸ê°€ ì·¨ì†Œë©ë‹ˆë‹¤.
- `cause` - í˜„ì¬ ë¼ìš°íŠ¸ ë§¤ì¹­ì˜ ì›ì¸ìœ¼ë¡œ, `enter` ë˜ëŠ” `stay` ì¤‘ í•˜ë‚˜ì…ë‹ˆë‹¤.
- `context` - ë¼ìš°íŠ¸ì˜ ì»¨í…ìŠ¤íŠ¸ ê°ì²´ë¡œ, ë‹¤ìŒ ë‘ ê°€ì§€ê°€ í•©ì³ì§„ í˜•íƒœì…ë‹ˆë‹¤:
  - ë¶€ëª¨ ë¼ìš°íŠ¸ ì»¨í…ìŠ¤íŠ¸
  - `beforeLoad` ì˜µì…˜ì—ì„œ ì œê³µëœ í˜„ì¬ ë¼ìš°íŠ¸ì˜ ì»¨í…ìŠ¤íŠ¸
- `deps` - `Route.loaderDeps` í•¨ìˆ˜ì—ì„œ ë°˜í™˜ëœ ê°ì²´ ê°’ì…ë‹ˆë‹¤. `Route.loaderDeps`ê°€ ì •ì˜ë˜ì§€ ì•Šì€ ê²½ìš°, ë¹ˆ ê°ì²´ê°€ ì œê³µë©ë‹ˆë‹¤.
- `location` - í˜„ì¬ ìœ„ì¹˜
- `params` - ë¼ìš°íŠ¸ì˜ ê²½ë¡œ ë§¤ê°œë³€ìˆ˜
- `parentMatchPromise` - `Promise<RouteMatch>` (ë£¨íŠ¸ ë¼ìš°íŠ¸ì˜ ê²½ìš° `undefined`)
- `preload` - ë¼ìš°íŠ¸ê°€ ë¡œë“œë˜ëŠ” ëŒ€ì‹  ë¯¸ë¦¬ ë¡œë“œë  ë•Œ `true`ê°€ ë˜ëŠ” ë¶ˆë¦¬ì–¸ ê°’
- `route` - ë¼ìš°íŠ¸ ìì²´

ì´ ë§¤ê°œë³€ìˆ˜ë“¤ì„ ì‚¬ìš©í•˜ë©´ ë‹¤ì–‘í•œ ì‘ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ë¨¼ì €, `loader` í•¨ìˆ˜ê°€ ì–´ë–»ê²Œ ì œì–´ë˜ê³  ì–¸ì œ í˜¸ì¶œë˜ëŠ”ì§€ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.


## `loader`ì—ì„œ ë°ì´í„° ì‚¬ìš©í•˜ê¸°

`loader`ì—ì„œ ë°ì´í„°ë¥¼ ì‚¬ìš©í•˜ë ¤ë©´ ë¼ìš°íŠ¸ ê°ì²´ì— ì •ì˜ëœ `useLoaderData` í›…ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.

```tsx
const posts = Route.useLoaderData()
```

ë§Œì•½ ë¼ìš°íŠ¸ ê°ì²´ì— ë°”ë¡œ ì ‘ê·¼í•  ìˆ˜ ì—†ëŠ” ê²½ìš°(ì˜ˆ: í˜„ì¬ ë¼ìš°íŠ¸ì˜ ê¹Šì€ ì»´í¬ë„ŒíŠ¸ íŠ¸ë¦¬ ë‚´ë¶€ì— ìˆëŠ” ê²½ìš°), `getRouteApi`ë¥¼ ì‚¬ìš©í•˜ì—¬ ë™ì¼í•œ í›…(ë˜ëŠ” ë¼ìš°íŠ¸ ê°ì²´ì˜ ë‹¤ë¥¸ í›…ë“¤)ì— ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ë°©ë²•ì€ ë¼ìš°íŠ¸ ê°ì²´ë¥¼ ì§ì ‘ ì„í¬íŠ¸í•˜ëŠ” ê²ƒë³´ë‹¤ ì„ í˜¸ë˜ì–´ì•¼ í•©ë‹ˆë‹¤. ë¼ìš°íŠ¸ ê°ì²´ë¥¼ ì„í¬íŠ¸í•˜ë©´ ìˆœí™˜ ì˜ì¡´ì„±ì´ ë°œìƒí•  ê°€ëŠ¥ì„±ì´ ë†’ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.

```tsx
import { getRouteApi } from '@tanstack/react-router'

// ì»´í¬ë„ŒíŠ¸ ë‚´ë¶€ì—ì„œ

const routeApi = getRouteApi('/posts')
const data = routeApi.useLoaderData()
```


## ì˜ì¡´ì„± ê¸°ë°˜ Stale-While-Revalidate ìºì‹±

TanStack RouterëŠ” ë¼ìš°íŠ¸ ë¡œë”ë¥¼ ìœ„í•œ ë‚´ì¥ëœ Stale-While-Revalidate ìºì‹± ê³„ì¸µì„ ì œê³µí•©ë‹ˆë‹¤. ì´ ìºì‹±ì€ ë¼ìš°íŠ¸ì˜ ì˜ì¡´ì„±ì„ ê¸°ë°˜ìœ¼ë¡œ í‚¤ë¥¼ ìƒì„±í•©ë‹ˆë‹¤:

- ë¼ìš°íŠ¸ì˜ ì™„ì „íˆ íŒŒì‹±ëœ ê²½ë¡œëª…
  - ì˜ˆ: `/posts/1` vs `/posts/2`
- `loaderDeps` ì˜µì…˜ì„ í†µí•´ ì œê³µëœ ì¶”ê°€ ì˜ì¡´ì„±
  - ì˜ˆ: `loaderDeps: ({ search: { pageIndex, pageSize } }) => ({ pageIndex, pageSize })`

ì´ëŸ¬í•œ ì˜ì¡´ì„±ì„ í‚¤ë¡œ ì‚¬ìš©í•˜ì—¬, TanStack RouterëŠ” ë¼ìš°íŠ¸ì˜ `loader` í•¨ìˆ˜ì—ì„œ ë°˜í™˜ëœ ë°ì´í„°ë¥¼ ìºì‹œì— ì €ì¥í•©ë‹ˆë‹¤. ì´í›„ ë™ì¼í•œ ë¼ìš°íŠ¸ ë§¤ì¹­ì— ëŒ€í•œ ìš”ì²­ì´ ë“¤ì–´ì˜¤ë©´ ìºì‹œëœ ë°ì´í„°ë¥¼ ì‚¬ìš©í•˜ì—¬ ì‘ë‹µí•©ë‹ˆë‹¤. ì¦‰, ë¼ìš°íŠ¸ ë°ì´í„°ê°€ ì´ë¯¸ ìºì‹œì— ìˆëŠ” ê²½ìš°, ì¦‰ì‹œ ë°˜í™˜ëœ í›„ ë°ì´í„°ì˜ **ì‹ ì„ ë„**ì— ë”°ë¼ ë°±ê·¸ë¼ìš´ë“œì—ì„œ ë‹¤ì‹œ ê°€ì ¸ì˜¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.


### ì£¼ìš” ì˜µì…˜

TanStack RouterëŠ” ë¼ìš°íŠ¸ ë¡œë”ì˜ í‚¤(key) ì„¤ì •ê³¼ ìºì‹± ë™ì‘ì„ ì œì–´í•˜ê¸° ìœ„í•œ ë‹¤ì–‘í•œ ì˜µì…˜ì„ ì œê³µí•©ë‹ˆë‹¤. ì´ ì˜µì…˜ë“¤ì„ ì—¬ëŸ¬ë¶„ì´ ì‚¬ìš©í•  ê°€ëŠ¥ì„±ì´ ë†’ì€ ìˆœì„œëŒ€ë¡œ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤:

- `routeOptions.loaderDeps`
  - ë¼ìš°í„°ì˜ ê²€ìƒ‰ íŒŒë¼ë¯¸í„°ë¥¼ ì œê³µí•˜ê³ , `loader` í•¨ìˆ˜ì—ì„œ ì‚¬ìš©í•  ì˜ì¡´ì„± ê°ì²´ë¥¼ ë°˜í™˜í•˜ëŠ” í•¨ìˆ˜ì…ë‹ˆë‹¤. ë„¤ë¹„ê²Œì´ì…˜ ê°„ì— ì´ ì˜ì¡´ì„±ì´ ë³€ê²½ë˜ë©´, `staleTime` ì„¤ì •ê³¼ ìƒê´€ì—†ì´ ë¼ìš°íŠ¸ê°€ ë‹¤ì‹œ ë¡œë“œë©ë‹ˆë‹¤. ì˜ì¡´ì„±ì€ ê¹Šì€ ë¹„êµ(deep equality check)ë¥¼ í†µí•´ ë¹„êµë©ë‹ˆë‹¤.
  
- `routeOptions.staleTime`
- `routerOptions.defaultStaleTime`
  - ë¼ìš°íŠ¸ ë°ì´í„°ê°€ ì‹ ì„ í•˜ë‹¤ê³  ê°„ì£¼ë˜ëŠ” ì‹œê°„(ë°€ë¦¬ì´ˆ ë‹¨ìœ„)ì„ ì„¤ì •í•©ë‹ˆë‹¤. ì´ ì‹œê°„ ë™ì•ˆ ë°ì´í„°ë¥¼ ë‹¤ì‹œ ë¡œë“œí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
  
- `routeOptions.preloadStaleTime`
- `routerOptions.defaultPreloadStaleTime`
  - ë¼ìš°íŠ¸ ë°ì´í„°ë¥¼ ë¯¸ë¦¬ ê°€ì ¸ì˜¬ ë•Œ(preload) ì‹ ì„ í•˜ë‹¤ê³  ê°„ì£¼ë˜ëŠ” ì‹œê°„(ë°€ë¦¬ì´ˆ ë‹¨ìœ„)ì„ ì„¤ì •í•©ë‹ˆë‹¤.
  
- `routeOptions.gcTime`
- `routerOptions.defaultGcTime`
  - ë¼ìš°íŠ¸ ë°ì´í„°ê°€ ìºì‹œì— ìœ ì§€ë˜ëŠ” ì‹œê°„(ë°€ë¦¬ì´ˆ ë‹¨ìœ„)ì„ ì„¤ì •í•©ë‹ˆë‹¤. ì´ ì‹œê°„ì´ ì§€ë‚˜ë©´ ê°€ë¹„ì§€ ì»¬ë ‰ì…˜(garbage collection) ëŒ€ìƒì´ ë©ë‹ˆë‹¤.
  
- `routeOptions.shouldReload`
  - `beforeLoad`ì™€ `loaderContext` íŒŒë¼ë¯¸í„°ë¥¼ ë°›ì•„ ë¼ìš°íŠ¸ë¥¼ ë‹¤ì‹œ ë¡œë“œí• ì§€ ì—¬ë¶€ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ë¶ˆë¦¬ì–¸ ê°’ì„ ë°˜í™˜í•˜ëŠ” í•¨ìˆ˜ì…ë‹ˆë‹¤. ì´ ì˜µì…˜ì€ `staleTime`ê³¼ `loaderDeps`ë¥¼ ë„˜ì–´ì„œ ë¼ìš°íŠ¸ë¥¼ ì–¸ì œ ë‹¤ì‹œ ë¡œë“œí• ì§€ì— ëŒ€í•œ ì¶”ê°€ì ì¸ ì œì–´ë¥¼ ì œê³µí•˜ë©°, Remixì˜ `shouldLoad` ì˜µì…˜ê³¼ ìœ ì‚¬í•œ íŒ¨í„´ì„ êµ¬í˜„í•˜ëŠ” ë° ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì´ ì˜µì…˜ë“¤ì„ í™œìš©í•˜ë©´ ë¼ìš°íŠ¸ ë°ì´í„°ì˜ ì‹ ì„ ë„ì™€ ìºì‹± ë™ì‘ì„ ì„¸ë°€í•˜ê²Œ ì œì–´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.


### âš ï¸ ëª‡ ê°€ì§€ ì¤‘ìš”í•œ ê¸°ë³¸ê°’

- ê¸°ë³¸ì ìœ¼ë¡œ `staleTime`ì€ `0`ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ì´ëŠ” ë¼ìš°íŠ¸ì˜ ë°ì´í„°ê°€ í•­ìƒ ì˜¤ë˜ëœ ê²ƒìœ¼ë¡œ ê°„ì£¼ë˜ë©°, ë¼ìš°íŠ¸ê°€ ë‹¤ì‹œ ë§¤ì¹­ë  ë•Œë§ˆë‹¤ ë°±ê·¸ë¼ìš´ë“œì—ì„œ í•­ìƒ ë‹¤ì‹œ ë¡œë“œëœë‹¤ëŠ” ì˜ë¯¸ì…ë‹ˆë‹¤.
- ê¸°ë³¸ì ìœ¼ë¡œ, ì´ì „ì— ë¯¸ë¦¬ ë¡œë“œëœ ë¼ìš°íŠ¸ëŠ” **30ì´ˆ ë™ì•ˆ** ì‹ ì„ í•œ ìƒíƒœë¡œ ê°„ì£¼ë©ë‹ˆë‹¤. ì¦‰, ë¼ìš°íŠ¸ê°€ ë¯¸ë¦¬ ë¡œë“œëœ í›„ 30ì´ˆ ì´ë‚´ì— ë‹¤ì‹œ ë¯¸ë¦¬ ë¡œë“œë˜ë©´ ë‘ ë²ˆì§¸ ë¯¸ë¦¬ ë¡œë“œëŠ” ë¬´ì‹œë©ë‹ˆë‹¤. ì´ëŠ” ë„ˆë¬´ ìì£¼ ë°œìƒí•˜ëŠ” ë¶ˆí•„ìš”í•œ ë¯¸ë¦¬ ë¡œë“œë¥¼ ë°©ì§€í•˜ê¸° ìœ„í•¨ì…ë‹ˆë‹¤. **ë¼ìš°íŠ¸ê°€ ì¼ë°˜ì ìœ¼ë¡œ ë¡œë“œë  ë•ŒëŠ” í‘œì¤€ `staleTime`ì´ ì ìš©ë©ë‹ˆë‹¤.**
- ê¸°ë³¸ì ìœ¼ë¡œ `gcTime`ì€ **30ë¶„**ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ì´ëŠ” 30ë¶„ ë™ì•ˆ ì ‘ê·¼ë˜ì§€ ì•Šì€ ëª¨ë“  ë¼ìš°íŠ¸ ë°ì´í„°ê°€ ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ë˜ì–´ ìºì‹œì—ì„œ ì œê±°ëœë‹¤ëŠ” ì˜ë¯¸ì…ë‹ˆë‹¤.
- `router.invalidate()`ì„ ì‚¬ìš©í•˜ë©´ ëª¨ë“  í™œì„± ë¼ìš°íŠ¸ê°€ ì¦‰ì‹œ ë¡œë”ë¥¼ ë‹¤ì‹œ ë¡œë“œí•˜ê³ , ìºì‹œëœ ëª¨ë“  ë¼ìš°íŠ¸ì˜ ë°ì´í„°ë¥¼ ì˜¤ë˜ëœ ê²ƒìœ¼ë¡œ í‘œì‹œí•©ë‹ˆë‹¤.


### `loaderDeps`ë¥¼ ì‚¬ìš©í•´ ê²€ìƒ‰ íŒŒë¼ë¯¸í„°ì— ì ‘ê·¼í•˜ê¸°

`/posts` ë¼ìš°íŠ¸ê°€ `offset`ê³¼ `limit`ì´ë¼ëŠ” ê²€ìƒ‰ íŒŒë¼ë¯¸í„°ë¥¼ í†µí•´ í˜ì´ì§€ë„¤ì´ì…˜ì„ ì§€ì›í•œë‹¤ê³  ê°€ì •í•´ ë´…ì‹œë‹¤. ìºì‹œê°€ ì´ ë°ì´í„°ë¥¼ ê³ ìœ í•˜ê²Œ ì €ì¥í•˜ë ¤ë©´, `loaderDeps` í•¨ìˆ˜ë¥¼ í†µí•´ ì´ëŸ¬í•œ ê²€ìƒ‰ íŒŒë¼ë¯¸í„°ì— ì ‘ê·¼í•´ì•¼ í•©ë‹ˆë‹¤. ì´ë¥¼ ëª…ì‹œì ìœ¼ë¡œ ì‹ë³„í•¨ìœ¼ë¡œì¨, ì„œë¡œ ë‹¤ë¥¸ `offset`ê³¼ `limit` ê°’ì„ ê°€ì§„ `/posts` ë¼ìš°íŠ¸ ë§¤ì¹˜ê°€ ì„œë¡œ ì„ì´ì§€ ì•Šê²Œ ë©ë‹ˆë‹¤!

ì´ëŸ¬í•œ ì˜ì¡´ì„±(deps)ì„ ì„¤ì •í•˜ë©´, ì˜ì¡´ì„±ì´ ë³€ê²½ë  ë•Œë§ˆë‹¤ ë¼ìš°íŠ¸ê°€ í•­ìƒ ë‹¤ì‹œ ë¡œë“œë©ë‹ˆë‹¤.

```tsx
// /routes/posts.tsx
export const Route = createFileRoute('/posts')({
  loaderDeps: ({ search: { offset, limit } }) => ({ offset, limit }),
  loader: ({ deps: { offset, limit } }) =>
    fetchPosts({
      offset,
      limit,
    }),
})
```


### `staleTime`ì„ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ê°€ ì‹ ì„ í•˜ë‹¤ê³  ê°„ì£¼ë˜ëŠ” ì‹œê°„ ì œì–´í•˜ê¸°

ê¸°ë³¸ì ìœ¼ë¡œ ë„¤ë¹„ê²Œì´ì…˜ì˜ `staleTime`ì€ `0`msë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤(ë¯¸ë¦¬ ê°€ì ¸ì˜¤ê¸°(preload)ì˜ ê²½ìš° 30ì´ˆ). ì´ëŠ” ë¼ìš°íŠ¸ì˜ ë°ì´í„°ê°€ í•­ìƒ ì˜¤ë˜ëœ ê²ƒìœ¼ë¡œ ê°„ì£¼ë˜ë©°, ë¼ìš°íŠ¸ê°€ ë§¤ì¹­ë˜ê³  ë„¤ë¹„ê²Œì´ì…˜ë  ë•Œë§ˆë‹¤ ë°±ê·¸ë¼ìš´ë“œì—ì„œ í•­ìƒ ë‹¤ì‹œ ë¡œë“œëœë‹¤ëŠ” ì˜ë¯¸ì…ë‹ˆë‹¤.

**ì´ ì„¤ì •ì€ ëŒ€ë¶€ë¶„ì˜ ê²½ìš°ì— ì í•©í•˜ì§€ë§Œ, ì¼ë¶€ ë¼ìš°íŠ¸ ë°ì´í„°ëŠ” ë” ì •ì ì´ê±°ë‚˜ ë¡œë“œ ë¹„ìš©ì´ ë†’ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.** ì´ëŸ° ê²½ìš°ì—ëŠ” `staleTime` ì˜µì…˜ì„ ì‚¬ìš©í•˜ì—¬ ë¼ìš°íŠ¸ ë°ì´í„°ê°€ ì‹ ì„ í•˜ë‹¤ê³  ê°„ì£¼ë˜ëŠ” ì‹œê°„ì„ ì œì–´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì˜ˆì œë¥¼ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤:

```tsx
// /routes/posts.tsx
export const Route = createFileRoute('/posts')({
  loader: () => fetchPosts(),
  // ë¼ìš°íŠ¸ ë°ì´í„°ë¥¼ 10ì´ˆ ë™ì•ˆ ì‹ ì„ í•˜ë‹¤ê³  ê°„ì£¼
  staleTime: 10_000,
})
```

`staleTime` ì˜µì…˜ì— `10_000`ì„ ì „ë‹¬í•˜ë©´, ë¼ìš°í„°ëŠ” ë¼ìš°íŠ¸ ë°ì´í„°ë¥¼ 10ì´ˆ ë™ì•ˆ ì‹ ì„ í•˜ë‹¤ê³  ê°„ì£¼í•©ë‹ˆë‹¤. ì¦‰, ì‚¬ìš©ìê°€ `/about`ì—ì„œ `/posts`ë¡œ 10ì´ˆ ì´ë‚´ì— ë‹¤ì‹œ ë„¤ë¹„ê²Œì´ì…˜í•˜ë©´, ë¼ìš°íŠ¸ ë°ì´í„°ëŠ” ë‹¤ì‹œ ë¡œë“œë˜ì§€ ì•ŠìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ 10ì´ˆê°€ ì§€ë‚œ í›„ì— `/about`ì—ì„œ `/posts`ë¡œ ë„¤ë¹„ê²Œì´ì…˜í•˜ë©´, ë¼ìš°íŠ¸ ë°ì´í„°ëŠ” **ë°±ê·¸ë¼ìš´ë“œì—ì„œ** ë‹¤ì‹œ ë¡œë“œë©ë‹ˆë‹¤.


## stale-while-revalidate ìºì‹± ë¹„í™œì„±í™”í•˜ê¸°

íŠ¹ì • ë¼ìš°íŠ¸ì—ì„œ stale-while-revalidate ìºì‹±ì„ ë¹„í™œì„±í™”í•˜ë ¤ë©´ `staleTime` ì˜µì…˜ì„ `Infinity`ë¡œ ì„¤ì •í•©ë‹ˆë‹¤:

```tsx
// /routes/posts.tsx
export const Route = createFileRoute('/posts')({
  loader: () => fetchPosts(),
  staleTime: Infinity,
})
```

ëª¨ë“  ë¼ìš°íŠ¸ì— ëŒ€í•´ ì´ ê¸°ëŠ¥ì„ ë¹„í™œì„±í™”í•˜ë ¤ë©´ ë¼ìš°í„°ì˜ `defaultStaleTime` ì˜µì…˜ì„ ì„¤ì •í•˜ë©´ ë©ë‹ˆë‹¤:

```tsx
const router = createRouter({
  routeTree,
  defaultStaleTime: Infinity,
})
```


## ìºì‹±ì—ì„œ ì œì™¸í•˜ê¸° ìœ„í•´ `shouldReload`ì™€ `gcTime` ì‚¬ìš©í•˜ê¸°

Remixì˜ ê¸°ë³¸ ê¸°ëŠ¥ê³¼ ìœ ì‚¬í•˜ê²Œ, íŠ¹ì • ë¼ìš°íŠ¸ê°€ ì§„ì…í•  ë•Œë‚˜ ì¤‘ìš”í•œ ë¡œë” ì˜ì¡´ì„±ì´ ë³€ê²½ë  ë•Œë§Œ ë¡œë“œë˜ë„ë¡ ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë¥¼ ìœ„í•´ `gcTime` ì˜µì…˜ê³¼ `shouldReload` ì˜µì…˜ì„ í•¨ê»˜ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. `shouldReload`ëŠ” `boolean` ê°’ì„ ë°›ê±°ë‚˜, `beforeLoad`ì™€ `loaderContext` íŒŒë¼ë¯¸í„°ë¥¼ ë°›ì•„ ë¼ìš°íŠ¸ë¥¼ ë‹¤ì‹œ ë¡œë“œí• ì§€ ì—¬ë¶€ë¥¼ ë‚˜íƒ€ë‚´ëŠ” `boolean`ì„ ë°˜í™˜í•˜ëŠ” í•¨ìˆ˜ë¥¼ ë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```tsx
// /routes/posts.tsx
export const Route = createFileRoute('/posts')({
  loaderDeps: ({ search: { offset, limit } }) => ({ offset, limit }),
  loader: ({ deps }) => fetchPosts(deps),
  // ì´ ë¼ìš°íŠ¸ì˜ ë°ì´í„°ë¥¼ ì–¸ë¡œë“œ í›„ ìºì‹œí•˜ì§€ ì•ŠìŒ
  gcTime: 0,
  // ì‚¬ìš©ìê°€ ë¼ìš°íŠ¸ë¡œ ì´ë™í•˜ê±°ë‚˜ ì˜ì¡´ì„±ì´ ë³€ê²½ë  ë•Œë§Œ ë‹¤ì‹œ ë¡œë“œ
  shouldReload: false,
})
```


### ìºì‹±ì„ ì‚¬ìš©í•˜ì§€ ì•Šìœ¼ë©´ì„œë„ ë¯¸ë¦¬ ê°€ì ¸ì˜¤ê¸° í™œìš©í•˜ê¸°

ë¼ìš°íŠ¸ ë°ì´í„°ì— ëŒ€í•œ ë‹¨ê¸° ìºì‹±ì„ ì‚¬ìš©í•˜ì§€ ì•Šê¸°ë¡œ ê²°ì •í–ˆë”ë¼ë„, ë¯¸ë¦¬ ê°€ì ¸ì˜¤ê¸°ì˜ ì´ì ì„ ì—¬ì „íˆ ëˆ„ë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ìœ„ì˜ ì„¤ì •ì„ ì‚¬ìš©í•˜ë©´ ê¸°ë³¸ `preloadGcTime`ê³¼ í•¨ê»˜ ë¯¸ë¦¬ ê°€ì ¸ì˜¤ê¸°ê°€ ê·¸ëŒ€ë¡œ ì‘ë™í•©ë‹ˆë‹¤. ì¦‰, ë¼ìš°íŠ¸ê°€ ë¯¸ë¦¬ ê°€ì ¸ì˜¤ê¸°ë˜ê³  ë„¤ë¹„ê²Œì´ì…˜ìœ¼ë¡œ ì´ë™í•˜ë©´, í•´ë‹¹ ë¼ìš°íŠ¸ì˜ ë°ì´í„°ëŠ” ìµœì‹  ìƒíƒœë¡œ ê°„ì£¼ë˜ì–´ ë‹¤ì‹œ ë¶ˆëŸ¬ì˜¤ì§€ ì•ŠìŠµë‹ˆë‹¤.

ë¯¸ë¦¬ ê°€ì ¸ì˜¤ê¸°ë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šìœ¼ë ¤ë©´, `routerOptions.defaultPreload` ë˜ëŠ” `routeOptions.preload` ì˜µì…˜ì„ í†µí•´ í™œì„±í™”í•˜ì§€ ì•Šìœ¼ë©´ ë©ë‹ˆë‹¤.


## ëª¨ë“  ë¡œë” ì´ë²¤íŠ¸ë¥¼ ì™¸ë¶€ ìºì‹œë¡œ ì „ë‹¬í•˜ê¸°

ì´ ì‚¬ìš© ì‚¬ë¡€ëŠ” [ì™¸ë¶€ ë°ì´í„° ë¡œë”©](./external-data-loading.md) í˜ì´ì§€ì—ì„œ ìì„¸íˆ ì„¤ëª…í•˜ì§€ë§Œ, TanStack Queryì™€ ê°™ì€ ì™¸ë¶€ ìºì‹œë¥¼ ì‚¬ìš©í•˜ê³  ì‹¶ë‹¤ë©´ ëª¨ë“  ë¡œë” ì´ë²¤íŠ¸ë¥¼ ì™¸ë¶€ ìºì‹œë¡œ ì „ë‹¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê¸°ë³¸ ì„¤ì •ì„ ì‚¬ìš© ì¤‘ì´ë¼ë©´, ë¼ìš°í„°ì˜ `defaultPreloadStaleTime` ì˜µì…˜ì„ `0`ìœ¼ë¡œ ì„¤ì •í•˜ëŠ” ê²ƒë§Œ ë³€ê²½í•˜ë©´ ë©ë‹ˆë‹¤.

```tsx
const router = createRouter({
  routeTree,
  defaultPreloadStaleTime: 0,
})
```

ì´ë ‡ê²Œ í•˜ë©´ ëª¨ë“  ë¯¸ë¦¬ ê°€ì ¸ì˜¤ê¸°(preload), ë¡œë“œ(load), ê·¸ë¦¬ê³  ë‹¤ì‹œ ë¡œë“œ(reload) ì´ë²¤íŠ¸ê°€ `loader` í•¨ìˆ˜ë¥¼ íŠ¸ë¦¬ê±°í•˜ê²Œ ë©ë‹ˆë‹¤. ì´ ì´ë²¤íŠ¸ë“¤ì€ ì™¸ë¶€ ìºì‹œì—ì„œ ì²˜ë¦¬ë˜ê³  ì¤‘ë³µ ì œê±°ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.


## ë¼ìš°í„° ì»¨í…ìŠ¤íŠ¸ ì‚¬ìš©í•˜ê¸°

`loader` í•¨ìˆ˜ì— ì „ë‹¬ë˜ëŠ” `context` ì¸ìëŠ” ë‹¤ìŒ ë‘ ê°€ì§€ë¥¼ ë³‘í•©í•œ ê°ì²´ì…ë‹ˆë‹¤:

- ìƒìœ„ ë¼ìš°íŠ¸ì˜ ì»¨í…ìŠ¤íŠ¸
- `beforeLoad` ì˜µì…˜ì„ í†µí•´ ì œê³µëœ í˜„ì¬ ë¼ìš°íŠ¸ì˜ ì»¨í…ìŠ¤íŠ¸

ë¼ìš°í„°ì˜ ìµœìƒë‹¨ì—ì„œ `context` ì˜µì…˜ì„ í†µí•´ ì´ˆê¸° ì»¨í…ìŠ¤íŠ¸ë¥¼ ë¼ìš°í„°ì— ì „ë‹¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ì»¨í…ìŠ¤íŠ¸ëŠ” ë¼ìš°í„°ì˜ ëª¨ë“  ë¼ìš°íŠ¸ì—ì„œ ì‚¬ìš© ê°€ëŠ¥í•˜ë©°, ê° ë¼ìš°íŠ¸ê°€ ë§¤ì¹­ë  ë•Œ ë³µì‚¬ë˜ê³  í™•ì¥ë©ë‹ˆë‹¤. ì´ëŠ” `beforeLoad` ì˜µì…˜ì„ í†µí•´ ë¼ìš°íŠ¸ì— ì»¨í…ìŠ¤íŠ¸ë¥¼ ì „ë‹¬í•¨ìœ¼ë¡œì¨ ì´ë£¨ì–´ì§‘ë‹ˆë‹¤. ì´ ì»¨í…ìŠ¤íŠ¸ëŠ” í•´ë‹¹ ë¼ìš°íŠ¸ì˜ ëª¨ë“  ìì‹ ë¼ìš°íŠ¸ì—ì„œë„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê²°ê³¼ì ìœ¼ë¡œ ìƒì„±ëœ ì»¨í…ìŠ¤íŠ¸ëŠ” ë¼ìš°íŠ¸ì˜ `loader` í•¨ìˆ˜ì—ì„œ ì‚¬ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤.

ì´ ì˜ˆì œì—ì„œëŠ” ë¼ìš°íŠ¸ ì»¨í…ìŠ¤íŠ¸ì— ê²Œì‹œë¬¼ì„ ê°€ì ¸ì˜¤ëŠ” í•¨ìˆ˜ë¥¼ ë§Œë“¤ê³ , `loader` í•¨ìˆ˜ì—ì„œ ì´ë¥¼ ì‚¬ìš©í•´ ë³´ê² ìŠµë‹ˆë‹¤.

> ğŸ§  ì»¨í…ìŠ¤íŠ¸ëŠ” ì˜ì¡´ì„± ì£¼ì…ì„ ìœ„í•œ ê°•ë ¥í•œ ë„êµ¬ì…ë‹ˆë‹¤. ì´ë¥¼ í†µí•´ ì„œë¹„ìŠ¤, í›…, ê·¸ë¦¬ê³  ë‹¤ë¥¸ ê°ì²´ë“¤ì„ ë¼ìš°í„°ì™€ ë¼ìš°íŠ¸ì— ì£¼ì…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë˜í•œ ë¼ìš°íŠ¸ì˜ `beforeLoad` ì˜µì…˜ì„ ì‚¬ìš©í•´ ë¼ìš°íŠ¸ íŠ¸ë¦¬ì˜ ëª¨ë“  ë¼ìš°íŠ¸ì— ë°ì´í„°ë¥¼ ì „ë‹¬í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.

- `/utils/fetchPosts.tsx`

```tsx
export const fetchPosts = async () => {
  const res = await fetch(`/api/posts?page=${pageIndex}`);
  if (!res.ok) throw new Error('ê²Œì‹œë¬¼ì„ ê°€ì ¸ì˜¤ëŠ” ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤');
  return res.json();
};
```

- `/routes/__root.tsx`

```tsx
import { createRootRouteWithContext } from '@tanstack/react-router';

// createRootRouteWithContext() í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ ë£¨íŠ¸ ë¼ìš°íŠ¸ë¥¼ ìƒì„±í•˜ê³ ,
// ë¼ìš°í„° ì»¨í…ìŠ¤íŠ¸ì—ì„œ ì‚¬ìš©í•  íƒ€ì…ì„ ì „ë‹¬í•©ë‹ˆë‹¤.
export const Route = createRootRouteWithContext<{
  fetchPosts: typeof fetchPosts;
}>()(); // NOTE: createRootRouteWithContextëŠ” íŒ©í† ë¦¬ í•¨ìˆ˜ì´ë¯€ë¡œ ë‘ ë²ˆ í˜¸ì¶œí•©ë‹ˆë‹¤.
```

- `/routes/posts.tsx`

```tsx
import { createFileRoute } from '@tanstack/react-router';

// postsRouteê°€ ì»¨í…ìŠ¤íŠ¸ì—ì„œ fetchPosts í•¨ìˆ˜ë¥¼ ì°¸ì¡°í•˜ëŠ” ë°©ì‹ì„ ì£¼ëª©í•˜ì„¸ìš”.
// ì´ëŠ” ë¼ìš°í„°ì™€ ë¼ìš°íŠ¸ ê°„ì˜ ì˜ì¡´ì„± ì£¼ì…ì„ ìœ„í•œ ê°•ë ¥í•œ ë„êµ¬ê°€ ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
export const Route = createFileRoute('/posts')({
  loader: ({ context: { fetchPosts } }) => fetchPosts(),
});
```

- `/router.tsx`

```tsx
import { routeTree } from './routeTree.gen';

// routerContextë¥¼ ì‚¬ìš©í•´ ìƒˆë¡œìš´ ë¼ìš°í„°ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.
// ì´ë•Œ ë¼ìš°í„° ì»¨í…ìŠ¤íŠ¸ì˜ íƒ€ì… ìš”êµ¬ì‚¬í•­ì„ ì¶©ì¡±í•´ì•¼ í•©ë‹ˆë‹¤.
const router = createRouter({
  routeTree,
  context: {
    // ë¼ìš°í„° ì»¨í…ìŠ¤íŠ¸ì— fetchPosts í•¨ìˆ˜ë¥¼ ì œê³µí•©ë‹ˆë‹¤.
    fetchPosts,
  },
});
```


## ê²½ë¡œ íŒŒë¼ë¯¸í„° ì‚¬ìš©í•˜ê¸°

`loader` í•¨ìˆ˜ì—ì„œ ê²½ë¡œ íŒŒë¼ë¯¸í„°ë¥¼ ì‚¬ìš©í•˜ë ¤ë©´, í•¨ìˆ˜ì˜ ë§¤ê°œë³€ìˆ˜ì— ìˆëŠ” `params` ì†ì„±ì„ í†µí•´ ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì•„ë˜ ì˜ˆì œë¥¼ ì°¸ê³ í•˜ì„¸ìš”:

```tsx
// routes/posts.$postId.tsx
export const Route = createFileRoute('/posts/$postId')({
  loader: ({ params: { postId } }) => fetchPostById(postId),
})
```

ì´ ì˜ˆì œì—ì„œëŠ” `postId`ë¼ëŠ” ê²½ë¡œ íŒŒë¼ë¯¸í„°ë¥¼ ì‚¬ìš©í•˜ì—¬ `fetchPostById` í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•©ë‹ˆë‹¤. `params` ê°ì²´ì—ì„œ `postId`ë¥¼ ì¶”ì¶œí•˜ì—¬ ì‚¬ìš©í•˜ëŠ” ë°©ì‹ì…ë‹ˆë‹¤.


## ë¼ìš°íŠ¸ ì»¨í…ìŠ¤íŠ¸ ì‚¬ìš©í•˜ê¸°

ì „ì—­ ì»¨í…ìŠ¤íŠ¸ë¥¼ ë¼ìš°í„°ì— ì „ë‹¬í•˜ëŠ” ê²ƒì€ ì¢‹ì§€ë§Œ, íŠ¹ì • ë¼ìš°íŠ¸ì—ë§Œ ì ìš©ë˜ëŠ” ì»¨í…ìŠ¤íŠ¸ë¥¼ ì œê³µí•˜ê³  ì‹¶ë‹¤ë©´ ì–´ë–»ê²Œ í•´ì•¼ í• ê¹Œìš”? ì´ë•Œ `beforeLoad` ì˜µì…˜ì´ ìœ ìš©í•©ë‹ˆë‹¤. `beforeLoad`ëŠ” ë¼ìš°íŠ¸ë¥¼ ë¡œë“œí•˜ê¸° ì§ì „ì— ì‹¤í–‰ë˜ëŠ” í•¨ìˆ˜ë¡œ, `loader`ì™€ ë™ì¼í•œ ë§¤ê°œë³€ìˆ˜ë¥¼ ë°›ìŠµë‹ˆë‹¤. ì´ í•¨ìˆ˜ëŠ” ë¦¬ë‹¤ì´ë ‰íŠ¸ë¥¼ ì²˜ë¦¬í•˜ê±°ë‚˜ ë¡œë” ìš”ì²­ì„ ì°¨ë‹¨í•˜ëŠ” ë“±ì˜ ê¸°ëŠ¥ ì™¸ì—ë„, ë¼ìš°íŠ¸ ì»¨í…ìŠ¤íŠ¸ì— ë³‘í•©ë  ê°ì²´ë¥¼ ë°˜í™˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì•„ë˜ ì˜ˆì œë¥¼ í†µí•´ `beforeLoad` ì˜µì…˜ì„ ì‚¬ìš©í•´ ë¼ìš°íŠ¸ ì»¨í…ìŠ¤íŠ¸ì— ë°ì´í„°ë¥¼ ì£¼ì…í•˜ëŠ” ë°©ë²•ì„ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.

```tsx
// /routes/posts.tsx
import { createFileRoute } from '@tanstack/react-router'

export const Route = createFileRoute('/posts')({
  // fetchPosts í•¨ìˆ˜ë¥¼ ë¼ìš°íŠ¸ ì»¨í…ìŠ¤íŠ¸ì— ì „ë‹¬
  beforeLoad: () => ({
    fetchPosts: () => console.info('foo'),
  }),
  loader: ({ context: { fetchPosts } }) => {
    console.info(fetchPosts()) // 'foo'

    // ...
  },
})
```

ì´ ì˜ˆì œì—ì„œëŠ” `beforeLoad` í•¨ìˆ˜ê°€ `fetchPosts` í•¨ìˆ˜ë¥¼ ë°˜í™˜í•˜ê³ , ì´ í•¨ìˆ˜ëŠ” ë¼ìš°íŠ¸ ì»¨í…ìŠ¤íŠ¸ì— ì¶”ê°€ë©ë‹ˆë‹¤. ì´í›„ `loader` í•¨ìˆ˜ì—ì„œ ì´ ì»¨í…ìŠ¤íŠ¸ë¥¼ ì‚¬ìš©í•´ `fetchPosts`ë¥¼ í˜¸ì¶œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.


## ë¡œë”ì—ì„œ ê²€ìƒ‰ íŒŒë¼ë¯¸í„° ì‚¬ìš©í•˜ê¸°

> â“ ì ê¹ë§Œìš”, Tanner... ë‚´ ê²€ìƒ‰ íŒŒë¼ë¯¸í„°ëŠ” ì–´ë””ì— ìˆë‚˜ìš”?!

ì—¬ëŸ¬ë¶„ì€ ì™œ `search`ê°€ `loader` í•¨ìˆ˜ì˜ ë§¤ê°œë³€ìˆ˜ì— ì§ì ‘ì ìœ¼ë¡œ ì œê³µë˜ì§€ ì•ŠëŠ”ì§€ ê¶ê¸ˆí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŠ” ì˜ë„ì ìœ¼ë¡œ ì„¤ê³„ëœ ë¶€ë¶„ìœ¼ë¡œ, ì—¬ëŸ¬ë¶„ì´ ë” ë‚˜ì€ ê²°ê³¼ë¥¼ ì–»ì„ ìˆ˜ ìˆë„ë¡ ë•ê¸° ìœ„í•¨ì…ë‹ˆë‹¤. ê·¸ ì´ìœ ë¥¼ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.

- **ê²€ìƒ‰ íŒŒë¼ë¯¸í„°**ê°€ ë¡œë” í•¨ìˆ˜ì—ì„œ ì‚¬ìš©ëœë‹¤ë©´, ì´ëŠ” í•´ë‹¹ ê²€ìƒ‰ íŒŒë¼ë¯¸í„°ê°€ ë¡œë“œë˜ëŠ” ë°ì´í„°ë¥¼ ê³ ìœ í•˜ê²Œ ì‹ë³„í•˜ëŠ” ë°ì—ë„ ì‚¬ìš©ë˜ì–´ì•¼ í•œë‹¤ëŠ” ì¢‹ì€ ì§€í‘œì…ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, `pageIndex`ì™€ ê°™ì€ ê²€ìƒ‰ íŒŒë¼ë¯¸í„°ë¥¼ ì‚¬ìš©í•˜ëŠ” ë¼ìš°íŠ¸ê°€ ìˆë‹¤ë©´, ì´ íŒŒë¼ë¯¸í„°ëŠ” ë¼ìš°íŠ¸ ë§¤ì¹˜ ë‚´ë¶€ì˜ ë°ì´í„°ë¥¼ ê³ ìœ í•˜ê²Œ ì‹ë³„í•˜ëŠ” ë° ì‚¬ìš©ë©ë‹ˆë‹¤. ë˜ëŠ” `/users/user` ë¼ìš°íŠ¸ì—ì„œ `userId` ê²€ìƒ‰ íŒŒë¼ë¯¸í„°ë¥¼ ì‚¬ìš©í•˜ì—¬ íŠ¹ì • ì‚¬ìš©ìë¥¼ ì‹ë³„í•œë‹¤ë©´, URLì„ `/users/user?userId=123`ê³¼ ê°™ì´ ëª¨ë¸ë§í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ê²½ìš° `user` ë¼ìš°íŠ¸ëŠ” íŠ¹ì • ì‚¬ìš©ìë¥¼ ì‹ë³„í•˜ê¸° ìœ„í•´ ì¶”ê°€ì ì¸ ë„ì›€ì´ í•„ìš”í•©ë‹ˆë‹¤.
- ë¡œë” í•¨ìˆ˜ì—ì„œ ê²€ìƒ‰ íŒŒë¼ë¯¸í„°ì— ì§ì ‘ ì ‘ê·¼í•˜ë©´, ìºì‹± ë° ë¯¸ë¦¬ ê°€ì ¸ì˜¤ê¸°(preloading)ì—ì„œ ë²„ê·¸ê°€ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŠ” ë¡œë“œë˜ëŠ” ë°ì´í„°ê°€ í˜„ì¬ URL ê²½ë¡œì™€ ê²€ìƒ‰ íŒŒë¼ë¯¸í„°ì— ê³ ìœ í•˜ì§€ ì•Šê¸° ë•Œë¬¸ì…ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, `/posts` ë¼ìš°íŠ¸ì—ì„œ 2í˜ì´ì§€ì˜ ê²°ê³¼ë¥¼ ë¯¸ë¦¬ ê°€ì ¸ì˜¤ë„ë¡ ìš”ì²­í•  ìˆ˜ ìˆì§€ë§Œ, ë¼ìš°íŠ¸ ì„¤ì •ì—ì„œ í˜ì´ì§€ë¥¼ êµ¬ë¶„í•˜ì§€ ì•Šìœ¼ë©´, `/posts` ë˜ëŠ” `?page=1` í™”ë©´ì—ì„œ 2í˜ì´ì§€ì˜ ë°ì´í„°ë¥¼ ê°€ì ¸ì™€ ì €ì¥í•˜ê³  í‘œì‹œí•˜ê²Œ ë©ë‹ˆë‹¤. ì´ëŠ” ë¯¸ë¦¬ ê°€ì ¸ì˜¤ê¸°ê°€ ë°°ê²½ì—ì„œ ì´ë£¨ì–´ì§€ëŠ” ê²ƒì´ ì•„ë‹ˆë¼, ì˜ëª»ëœ í™”ë©´ì— í‘œì‹œë˜ëŠ” ê²°ê³¼ë¥¼ ì´ˆë˜í•©ë‹ˆë‹¤.
- ê²€ìƒ‰ íŒŒë¼ë¯¸í„°ì™€ ë¡œë” í•¨ìˆ˜ ì‚¬ì´ì— ì„ê³„ê°’ì„ ë‘ë©´, ë¼ìš°í„°ê°€ ì—¬ëŸ¬ë¶„ì˜ ì˜ì¡´ì„±ê³¼ ë°˜ì‘ì„±ì„ ì´í•´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```tsx
// /routes/users.user.tsx
export const Route = createFileRoute('/users/user')({
  validateSearch: (search) =>
    search as {
      userId: string
    },
  loaderDeps: ({ search: { userId } }) => ({
    userId,
  }),
  loader: async ({ deps: { userId } }) => getUser(userId),
})
```

ì´ ì½”ë“œëŠ” `/users/user` ë¼ìš°íŠ¸ì—ì„œ `userId` ê²€ìƒ‰ íŒŒë¼ë¯¸í„°ë¥¼ ì‚¬ìš©í•˜ì—¬ íŠ¹ì • ì‚¬ìš©ì ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ëŠ” ì˜ˆì œì…ë‹ˆë‹¤. `validateSearch`ë¥¼ í†µí•´ ê²€ìƒ‰ íŒŒë¼ë¯¸í„°ë¥¼ ê²€ì¦í•˜ê³ , `loaderDeps`ë¥¼ í†µí•´ ì˜ì¡´ì„±ì„ ëª…ì‹œì ìœ¼ë¡œ ì •ì˜í•©ë‹ˆë‹¤. ì´ë ‡ê²Œ í•˜ë©´ ë¼ìš°í„°ê°€ ë°ì´í„°ë¥¼ ì˜¬ë°”ë¥´ê²Œ ìºì‹±í•˜ê³  ë¯¸ë¦¬ ê°€ì ¸ì˜¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.


### `routeOptions.loaderDeps`ë¥¼ í†µí•´ ê²€ìƒ‰ íŒŒë¼ë¯¸í„° ì ‘ê·¼í•˜ê¸°

```tsx
// /routes/posts.tsx
export const Route = createFileRoute('/posts')({
  // zodë¥¼ ì‚¬ìš©í•´ ê²€ìƒ‰ íŒŒë¼ë¯¸í„°ë¥¼ ê²€ì¦í•˜ê³  íŒŒì‹±
  validateSearch: z.object({
    offset: z.number().int().nonnegative().catch(0),
  }),
  // loaderDeps í•¨ìˆ˜ë¥¼ í†µí•´ offsetì„ ë¡œë” ì˜ì¡´ì„±ì— ì „ë‹¬
  loaderDeps: ({ search: { offset } }) => ({ offset }),
  // ì»¨í…ìŠ¤íŠ¸ì—ì„œ offsetì„ ê°€ì ¸ì™€ ë¡œë” í•¨ìˆ˜ì—ì„œ ì‚¬ìš©
  loader: async ({ deps: { offset } }) =>
    fetchPosts({
      offset,
    }),
})
```

ì´ ì½”ë“œëŠ” `/posts` ë¼ìš°íŠ¸ë¥¼ ì •ì˜í•˜ë©°, ê²€ìƒ‰ íŒŒë¼ë¯¸í„°ë¡œ ì „ë‹¬ëœ `offset` ê°’ì„ ì‚¬ìš©í•´ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì˜ˆì œì…ë‹ˆë‹¤. `validateSearch`ë¥¼ í†µí•´ `offset` ê°’ì„ ê²€ì¦í•˜ê³ , `loaderDeps`ë¥¼ í†µí•´ ë¡œë” í•¨ìˆ˜ì— í•„ìš”í•œ ì˜ì¡´ì„±ì„ ì „ë‹¬í•©ë‹ˆë‹¤. ë§ˆì§€ë§‰ìœ¼ë¡œ, `loader` í•¨ìˆ˜ì—ì„œ `offset` ê°’ì„ ì‚¬ìš©í•´ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.


## Abort Signal ì‚¬ìš©í•˜ê¸°

`loader` í•¨ìˆ˜ì˜ `abortController` ì†ì„±ì€ [AbortController](https://developer.mozilla.org/en-US/docs/Web/API/AbortController)ì…ë‹ˆë‹¤. ì´ ì‹œê·¸ë„ì€ ë¼ìš°íŠ¸ê°€ ì–¸ë¡œë“œë˜ê±°ë‚˜ `loader` í˜¸ì¶œì´ ë” ì´ìƒ ìœ íš¨í•˜ì§€ ì•Šì„ ë•Œ ì·¨ì†Œë©ë‹ˆë‹¤. ì´ ê¸°ëŠ¥ì€ ë¼ìš°íŠ¸ê°€ ì–¸ë¡œë“œë˜ê±°ë‚˜ ë¼ìš°íŠ¸ì˜ íŒŒë¼ë¯¸í„°ê°€ ë³€ê²½ë  ë•Œ ë„¤íŠ¸ì›Œí¬ ìš”ì²­ì„ ì·¨ì†Œí•˜ëŠ” ë° ìœ ìš©í•©ë‹ˆë‹¤. ì•„ë˜ëŠ” `fetch` í˜¸ì¶œê³¼ í•¨ê»˜ ì‚¬ìš©í•˜ëŠ” ì˜ˆì œì…ë‹ˆë‹¤:

```tsx
// routes/posts.tsx
export const Route = createFileRoute('/posts')({
  loader: ({ abortController }) =>
    fetchPosts({
      // ì´ ì‹œê·¸ë„ì„ fetch í˜¸ì¶œì´ë‚˜ ì‹œê·¸ë„ì„ ì§€ì›í•˜ëŠ” ì–´ë–¤ ê²ƒì— ì „ë‹¬
      signal: abortController.signal,
    }),
})
```


## `preload` í”Œë˜ê·¸ ì‚¬ìš©í•˜ê¸°

`loader` í•¨ìˆ˜ì˜ `preload` ì†ì„±ì€ ë¼ìš°íŠ¸ê°€ ë¡œë“œë˜ëŠ” ëŒ€ì‹  ë¯¸ë¦¬ ë¡œë“œë  ë•Œ `true`ë¡œ ì„¤ì •ë˜ëŠ” ë¶ˆë¦¬ì–¸ ê°’ì…ë‹ˆë‹¤. ì¼ë¶€ ë°ì´í„° ë¡œë”© ë¼ì´ë¸ŒëŸ¬ë¦¬ëŠ” ì¼ë°˜ì ì¸ fetchì™€ ë‹¤ë¥´ê²Œ ë¯¸ë¦¬ ë¡œë“œë¥¼ ì²˜ë¦¬í•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ, ì—¬ëŸ¬ë¶„ì€ `preload`ë¥¼ ë°ì´í„° ë¡œë”© ë¼ì´ë¸ŒëŸ¬ë¦¬ì— ì „ë‹¬í•˜ê±°ë‚˜ ì ì ˆí•œ ë°ì´í„° ë¡œë”© ë¡œì§ì„ ì‹¤í–‰í•˜ëŠ” ë° ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

```tsx
// routes/posts.tsx
export const Route = createFileRoute('/posts')({
  loader: async ({ preload }) =>
    fetchPosts({
      maxAge: preload ? 10_000 : 0, // ë¯¸ë¦¬ ë¡œë“œëœ ë°ì´í„°ëŠ” ì¡°ê¸ˆ ë” ì˜¤ë˜ ìœ ì§€
    }),
})
```


## ëŠë¦° ë¡œë” ì²˜ë¦¬í•˜ê¸°

ì´ìƒì ìœ¼ë¡œëŠ” ëŒ€ë¶€ë¶„ì˜ ë¼ìš°íŠ¸ ë¡œë”ê°€ ì§§ì€ ì‹œê°„ ë‚´ì— ë°ì´í„°ë¥¼ í•´ê²°í•  ìˆ˜ ìˆì–´ì•¼ í•©ë‹ˆë‹¤. ì´ë ‡ê²Œ ë˜ë©´ í”Œë ˆì´ìŠ¤í™€ë” ìŠ¤í”¼ë„ˆë¥¼ ë Œë”ë§í•  í•„ìš” ì—†ì´, ë‹¤ìŒ ë¼ìš°íŠ¸ê°€ ì™„ì „íˆ ì¤€ë¹„ë˜ì—ˆì„ ë•Œ suspenseë¥¼ í†µí•´ ë Œë”ë§í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ë¼ìš°íŠ¸ ì»´í¬ë„ŒíŠ¸ë¥¼ ë Œë”ë§í•˜ëŠ” ë° í•„ìš”í•œ ì¤‘ìš”í•œ ë°ì´í„°ê°€ ëŠë¦¬ê²Œ ë¡œë“œë˜ëŠ” ê²½ìš°, ë‘ ê°€ì§€ ì˜µì…˜ì´ ìˆìŠµë‹ˆë‹¤:

1. ë¹ ë¥¸ ë°ì´í„°ì™€ ëŠë¦° ë°ì´í„°ë¥¼ ë³„ë„ì˜ Promiseë¡œ ë¶„ë¦¬í•˜ê³ , ëŠë¦° ë°ì´í„°ëŠ” `defer`ë¥¼ ì‚¬ìš©í•´ ë¹ ë¥¸ ë°ì´í„°ê°€ ë¡œë“œëœ í›„ì— ì²˜ë¦¬í•©ë‹ˆë‹¤. (ìì„¸í•œ ë‚´ìš©ì€ [ì§€ì—°ëœ ë°ì´í„° ë¡œë”©](./deferred-data-loading.md) ê°€ì´ë“œë¥¼ ì°¸ê³ í•˜ì„¸ìš”.)
2. ëª¨ë“  ë°ì´í„°ê°€ ì¤€ë¹„ë  ë•Œê¹Œì§€ ë‚™ê´€ì ì¸ suspense ì„ê³„ê°’ ì´í›„ì— ë³´ë¥˜ ì¤‘ì¸ ì»´í¬ë„ŒíŠ¸ë¥¼ í‘œì‹œí•©ë‹ˆë‹¤. (ì•„ë˜ ë‚´ìš©ì„ ì°¸ê³ í•˜ì„¸ìš”.)


## ë¡œë”© ì¤‘ì¸ ì»´í¬ë„ŒíŠ¸ í‘œì‹œí•˜ê¸°

**ê¸°ë³¸ì ìœ¼ë¡œ TanStack RouterëŠ” 1ì´ˆ ì´ìƒ ê±¸ë¦¬ëŠ” ë¡œë”ì— ëŒ€í•´ ë¡œë”© ì¤‘ì¸ ì»´í¬ë„ŒíŠ¸ë¥¼ í‘œì‹œí•©ë‹ˆë‹¤.** ì´ëŠ” ë‚™ê´€ì ì¸ ì„ê³„ê°’ìœ¼ë¡œ, ë‹¤ìŒê³¼ ê°™ì€ ë°©ë²•ìœ¼ë¡œ ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

- `routeOptions.pendingMs` ë˜ëŠ”
- `routerOptions.defaultPendingMs`

ë¡œë”© ì‹œê°„ì´ ì„ê³„ê°’ì„ ì´ˆê³¼í•˜ë©´, ë¼ìš°í„°ëŠ” í•´ë‹¹ ë¼ìš°íŠ¸ì— ì„¤ì •ëœ `pendingComponent` ì˜µì…˜ì„ ë Œë”ë§í•©ë‹ˆë‹¤.


## Pending ì»´í¬ë„ŒíŠ¸ ê¹œë¹¡ì„ ë°©ì§€

Pending ì»´í¬ë„ŒíŠ¸ë¥¼ ì‚¬ìš©í•  ë•Œ, pending ì‹œê°„ ì„ê³„ê°’ì— ë„ë‹¬í•œ ì§í›„ ë°ì´í„°ê°€ ë°”ë¡œ í•´ê²°ë˜ë©´ pending ì»´í¬ë„ŒíŠ¸ê°€ ê¹œë¹¡ì´ëŠ” í˜„ìƒì´ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë¥¼ ë°©ì§€í•˜ê¸° ìœ„í•´ **TanStack RouterëŠ” ê¸°ë³¸ì ìœ¼ë¡œ pending ì»´í¬ë„ŒíŠ¸ë¥¼ ìµœì†Œ 500ms ë™ì•ˆ í‘œì‹œí•©ë‹ˆë‹¤**. ì´ ê°’ì€ ë‚™ê´€ì ì¸ ì„ê³„ê°’ìœ¼ë¡œ, ë‹¤ìŒê³¼ ê°™ì€ ë°©ë²•ìœ¼ë¡œ ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

- `routeOptions.pendingMinMs` ë˜ëŠ”
- `routerOptions.defaultPendingMinMs`


## ì—ëŸ¬ ì²˜ë¦¬í•˜ê¸°

TanStack RouterëŠ” ë¼ìš°íŠ¸ ë¡œë”© ìƒëª…ì£¼ê¸° ë™ì•ˆ ë°œìƒí•˜ëŠ” ì—ëŸ¬ë¥¼ ì²˜ë¦¬í•˜ëŠ” ëª‡ ê°€ì§€ ë°©ë²•ì„ ì œê³µí•©ë‹ˆë‹¤. ì´ì œ ê° ë°©ë²•ì„ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.


### `routeOptions.onError`ë¡œ ì—ëŸ¬ ì²˜ë¦¬í•˜ê¸°

`routeOptions.onError` ì˜µì…˜ì€ ë¼ìš°íŠ¸ ë¡œë”© ì¤‘ ì—ëŸ¬ê°€ ë°œìƒí–ˆì„ ë•Œ í˜¸ì¶œë˜ëŠ” í•¨ìˆ˜ì…ë‹ˆë‹¤.

```tsx
// routes/posts.tsx
export const Route = createFileRoute('/posts')({
  loader: () => fetchPosts(),
  onError: ({ error }) => {
    // ì—ëŸ¬ë¥¼ ë¡œê·¸ì— ê¸°ë¡
    console.error(error)
  },
})
```


### `routeOptions.onCatch`ë¥¼ ì‚¬ìš©í•œ ì—ëŸ¬ ì²˜ë¦¬

`routeOptions.onCatch` ì˜µì…˜ì€ ë¼ìš°í„°ì˜ `CatchBoundary`ì—ì„œ ì—ëŸ¬ê°€ ë°œìƒí–ˆì„ ë•Œ í˜¸ì¶œë˜ëŠ” í•¨ìˆ˜ì…ë‹ˆë‹¤.

```tsx
// routes/posts.tsx
export const Route = createFileRoute('/posts')({
  onCatch: ({ error, errorInfo }) => {
    // ì—ëŸ¬ë¥¼ ë¡œê·¸ì— ê¸°ë¡
    console.error(error)
  },
})
```


### `routeOptions.errorComponent`ë¡œ ì—ëŸ¬ ì²˜ë¦¬í•˜ê¸°

`routeOptions.errorComponent`ëŠ” ë¼ìš°íŠ¸ ë¡œë”©ì´ë‚˜ ë Œë”ë§ ê³¼ì •ì—ì„œ ì—ëŸ¬ê°€ ë°œìƒí–ˆì„ ë•Œ ë Œë”ë§ë˜ëŠ” ì»´í¬ë„ŒíŠ¸ì…ë‹ˆë‹¤. ì´ ì»´í¬ë„ŒíŠ¸ëŠ” ë‹¤ìŒê³¼ ê°™ì€ í”„ë¡œí¼í‹°ë¥¼ ë°›ìŠµë‹ˆë‹¤:

- `error` - ë°œìƒí•œ ì—ëŸ¬
- `reset` - ë‚´ë¶€ `CatchBoundary`ë¥¼ ë¦¬ì…‹í•˜ëŠ” í•¨ìˆ˜

```tsx
// routes/posts.tsx
export const Route = createFileRoute('/posts')({
  loader: () => fetchPosts(),
  errorComponent: ({ error }) => {
    // ì—ëŸ¬ ë©”ì‹œì§€ë¥¼ ë Œë”ë§
    return {error.message}
  },
})
```

`reset` í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ë©´ ì‚¬ìš©ìê°€ ì—ëŸ¬ ê²½ê³„ì˜ ì¼ë°˜ì ì¸ ìì‹ë“¤ì„ ë‹¤ì‹œ ë Œë”ë§í•˜ë„ë¡ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

```tsx
// routes/posts.tsx
export const Route = createFileRoute('/posts')({
  loader: () => fetchPosts(),
  errorComponent: ({ error, reset }) => {
    return (
      
        {error.message}
        <button
          onClick={() => {
            // ë¼ìš°í„° ì—ëŸ¬ ê²½ê³„ë¥¼ ë¦¬ì…‹
            reset()
          }}
        >
          ë‹¤ì‹œ ì‹œë„
        </button>
      
    )
  },
})
```

ë§Œì•½ ì—ëŸ¬ê°€ ë¼ìš°íŠ¸ ë¡œë”© ê³¼ì •ì—ì„œ ë°œìƒí–ˆë‹¤ë©´, `router.invalidate()`ë¥¼ í˜¸ì¶œí•´ì•¼ í•©ë‹ˆë‹¤. ì´ í•¨ìˆ˜ëŠ” ë¼ìš°í„°ë¥¼ ë‹¤ì‹œ ë¡œë“œí•˜ê³  ì—ëŸ¬ ê²½ê³„ë¥¼ ë¦¬ì…‹í•˜ëŠ” ì‘ì—…ì„ ë™ì‹œì— ìˆ˜í–‰í•©ë‹ˆë‹¤:

```tsx
// routes/posts.tsx
export const Route = createFileRoute('/posts')({
  loader: () => fetchPosts(),
  errorComponent: ({ error, reset }) => {
    const router = useRouter()

    return (
      
        {error.message}
        <button
          onClick={() => {
            // ë¼ìš°íŠ¸ë¥¼ ë¬´íš¨í™”í•˜ì—¬ ë¡œë”ë¥¼ ë‹¤ì‹œ ë¡œë“œí•˜ê³ , ì—ëŸ¬ ê²½ê³„ë„ ë¦¬ì…‹
            router.invalidate()
          }}
        >
          ë‹¤ì‹œ ì‹œë„
        </button>
      
    )
  },
})
```


### ê¸°ë³¸ `ErrorComponent` ì‚¬ìš©í•˜ê¸°

TanStack RouterëŠ” ë¼ìš°íŠ¸ ë¡œë”©ì´ë‚˜ ë Œë”ë§ ê³¼ì •ì—ì„œ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆì„ ë•Œ ë³´ì—¬ì£¼ëŠ” ê¸°ë³¸ `ErrorComponent`ë¥¼ ì œê³µí•©ë‹ˆë‹¤. ì—¬ëŸ¬ë¶„ì´ ë¼ìš°íŠ¸ì˜ ì˜¤ë¥˜ ì»´í¬ë„ŒíŠ¸ë¥¼ ì»¤ìŠ¤í…€í•˜ë”ë¼ë„, ì¡íˆì§€ ì•Šì€ ì˜¤ë¥˜ëŠ” ê¸°ë³¸ `ErrorComponent`ë¡œ í´ë°±(fallback)í•˜ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤.

```tsx
// routes/posts.tsx
import { createFileRoute, ErrorComponent } from '@tanstack/react-router'

export const Route = createFileRoute('/posts')({
  loader: () => fetchPosts(),
  errorComponent: ({ error }) => {
    if (error instanceof MyCustomError) {
      // ì»¤ìŠ¤í…€ ì˜¤ë¥˜ ë©”ì‹œì§€ ë Œë”ë§
      return {error.message}
    }

    // ê¸°ë³¸ ErrorComponentë¡œ í´ë°±
    return <ErrorComponent error={error} />
  },
})
```


